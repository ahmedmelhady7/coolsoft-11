<!--
@author Loaay Alkherbawy
@story  C4S01
The Search Results Viewer
--> <!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta charset="utf-8">
        <script src="@{'/public/javascripts/jquery-1.5.2.min.js'}" type="text/javascript" charset="utf-8">
        </script>
    </head>
    <style type="text/css">
        body {
            font-family: arial, helvetica;
            font-size: 20px;
            color: #123456;
            background-color: #A3D5E4;
        }
        
        #text1 {
            font-size: 500px;
            color: #654321;
        }
    </style>
    <div>
        <center>
            <img src="/public/images/Picture1.jpg">
            </img>
        </center>
    </div>
    <body onLoad="step1()">
        <form name="myform" action="@{quickSearch()}" method="GET">
        <font size="+3" color="993300">
            Welcome ${u.username}! 
        </font>
        </br>
        <a href="@{Login.index()}">Home</a>
        </br>
        <input type="text" id="search" name="search" value="enter a keyword here" /><input type="button" id="submit" name="submit" value="Search" onclick="quickSearch(this.form)"/><a href="AdvancedSearch">Advanced
            Search</a>
			</br>View: <SELECT NAME="view" onChange='modifyResult()'>
				 <OPTION VALUE="1">Abstract
				 <OPTION VALUE="2">Detailed
				 </SELECT>
        <script type="text/javascript">
            			
            			var marked = new Array();
            			
            			function step1() {
            				document.getElementById('div1').innerHTML = '<center>Searching</br><img src="/public/images/Loading.gif"/></center>';
            				setTimeout('viewResult()', 2500);
            			}
            
            			function viewResult(){
								document.getElementById('div1').innerHTML = "#{if lof}#{if organizationsFound} Found ${organizationsFound.size()} organization${organizationsFound.pluralize()}</br><ul> #{list items:organizationsFound, as:'org'}<li><a href='@{Organizations.viewProfile(org.id)}'>${org.toString()}</a></li>#{/list}</br></ul> #{/if}#{if entitiesFound} Found ${entitiesFound.size()} entity${entitiesFound.pluralize()}</br><ul> #{list items:entitiesFound, as:'item'}<li><a href='@{MainEntitys.show(item.id)}'>${item.toString()}</a></li>#{/list}</br></ul> #{/if} #{if topicsFound} Found ${topicsFound.size()} topic${topicsFound.pluralize()}</br><ul> #{list items:topicsFound, as:'item'}<li><a href='@{Topics.show(item.id)}'>${item.toString()}</a></li> #{/list}</br></ul> #{/if} #{if ideasFound} Found ${ideasFound.size()} idea${ideasFound.pluralize()}</br><ul> #{list items:ideasFound, as:'item'}<li><input type='checkbox' id = item.id onclick='mark(${item.id})'/><a href='@{Ideas.show(item.id)}'>${item.toString()}</a></li> #{/list}</br></ul><input type='button' value = 'Mark two ideas as duplicate' onclick='markDuplicate()'> #{/if}#{/if} #{else}<center><img src='/public/images/nothing.gif'></br> Sorry! My dog might be sick he can't smell anything :@</center> #{/else}";
						}
						
						function modifyResult(){
							switch(document.myform.view.value){
								case '1':
								document.getElementById('div1').innerHTML = "#{if lof}#{if organizationsFound} Found ${organizationsFound.size()} organization${organizationsFound.pluralize()}</br><ul> #{list items:organizationsFound, as:'org'}<li><a href='@{Organizations.viewProfile(org.id)}'>${org.toString()}</a></li>#{/list}</br></ul> #{/if}#{if entitiesFound} Found ${entitiesFound.size()} entity${entitiesFound.pluralize()}</br><ul> #{list items:entitiesFound, as:'item'}<li><a href='@{MainEntitys.show(item.id)}'>${item.toString()}</a></li>#{/list}</br></ul> #{/if} #{if topicsFound} Found ${topicsFound.size()} topic${topicsFound.pluralize()}</br><ul> #{list items:topicsFound, as:'item'}<li><a href='@{Topics.show(item.id)}'>${item.toString()}</a></li> #{/list}</br></ul> #{/if} #{if ideasFound} Found ${ideasFound.size()} idea${ideasFound.pluralize()}</br><ul> #{list items:ideasFound, as:'item'}<li><input type='checkbox' id = item.id onclick='mark(${item.id})'/><a href='@{Ideas.show(item.id)}'>${item.toString()}</a></li> #{/list}</br></ul><input type='button' value = 'Mark two ideas as duplicate' onclick='markDuplicate()'> #{/if}#{/if} #{else}<center><img src='/public/images/nothing.gif'></br> Sorry! My dog might be sick he can't smell anything :@</center> #{/else}";
								break;
								case '2':
								document.getElementById('div1').innerHTML = "#{if lof}#{if organizationsFound} Found ${organizationsFound.size()} organization${organizationsFound.pluralize()}</br><ul> #{list items:organizationsFound, as:'org'}<li><a href='@{Organizations.viewProfile(org.id)}'>${org.toString()}</a></br>${org.intializedIn.toString()}</li>#{/list}</br></ul> #{/if}#{if entitiesFound} Found ${entitiesFound.size()} entity${entitiesFound.pluralize()}</br><ul> #{list items:entitiesFound, as:'item'}<li><a href='@{MainEntitys.show(item.id)}'>${item.toString()}</a></br>Description: ${item.description}</li>#{/list}</br></ul> #{/if}#{if topicsFound} Found ${topicsFound.size()} topic${topicsFound.pluralize()}</br><ul>#{list items:topicsFound, as:'item'}<li><a href='@{Topics.show(item.id)}'>${item.toString()}</a></br>Description: ${item.description}</li>#{/list}</br></ul>#{/if}#{if ideasFound} Found ${ideasFound.size()} idea${ideasFound.pluralize()}</br><ul>#{list items:ideasFound, as:'item'}<li><input type='checkbox' id = item.id onclick='mark(${item.id})'/><a href='@{Ideas.show(item.id)}'>${item.toString()}</a></br>Description: ${item.description}</li>#{/list}</br></ul><input type='button' value = 'Mark two ideas as duplicate' onclick='markDuplicate()'>#{/if}#{/if}#{else}<center><img src='/public/images/nothing.gif'></br> Sorry! My dog might be sick he can't smell anything :@ </center>#{/else}";
								break;
								default:break;
							}
						}
            
            			function quickSearch(frm) {
            				$.post('@{quickSearch}', {
            					keyword : frm.search.value
            				}, function() {
            					window.location.reload(true);
            				});
            			}
            			function whichsortmethod(frm) {
            				var c = 'v';
            				var e = 'r';
            				if (document.getElementById("s1").checked) {
            					if (document.getElementById("v").checked) {
									//document.write(document.sort.v.name);
            						$.post('@{sortD}', {voteOrRate : document.sort.v.value}, function() {
            							window.location.reload(true);
            						});
            
            					} else if (document.getElementById("r").checked) {
									//document.write(document.sort.v.id);
            						$.post('@{sortD}', {voteOrRate : document.sort.v.value}, function() {
            							window.location.reload(true);
            						});
            					}
            
            				} else if (document.getElementById("v").checked) {
            					$.post('@{sortA}', {voteOrRate: document.sort.v.value}, function() {
            						window.location.reload(true);
            					});
            				} else if (document.getElementById("r").checked) {
            					$.post('@{sortA()}', {voteOrRate: frm.v.value}, function() {
            						window.location.reload(true);
            					});
            				}
            			}
            			function mark(id){
            				if (marked.indexOf(id) == -1 && marked.length < 2) {
            					marked.push(id);
            				}
            				else {
            					if (marked.indexOf(id) != -1){
            						marked.pop(id);
            					} 
            					else{
									alert("you could only mark two ideas");
									marked = new Array();
									window.location.reload(true);
            					}
            				}
            				}				
            				function markDuplicate(){
            					$.post('@{MarkRequest.sendRequest}',{idea1ID: marked[0],idea2ID: marked[1] ,des:"lol"}, function(){alert("The requests have been sent to the Topic organizer");});
            				}
            		
        </script>
        </form>
        <br/>
        <b>
            <big>
                <u>
                    Search Results:<a href="/filter_options"><i>Filter Results</i></a>
                </u>
            </big>
        </b>
		</br>
		</br>
	<form name = "sort">
    <input type="radio" name="s" id="s" value="A" />Ascending order <br>
    <input type="radio" name="s" id="s1" value="D" />descending order </br>
    <input type="radio" name="v" id="v" value="v" onclick="whichsortmethod(this.form)" />Vote <input type="radio"
     name="v" id="r" value="r" onclick="whichsortmethod(this.form)" />Rate
    </br>
   </form>
<div id='div1' align='left'>
</div>
</body>
</html>
