<!--
@author Loaay Alkherbawy
@story  C4S01
The Search Results Viewer
--> <!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta charset="utf-8">
        <script src="@{'/public/javascripts/jquery-1.5.2.min.js'}" type="text/javascript" charset="utf-8">
        </script>
    </head>
    <style type="text/css">
        body {
            font-family: arial, helvetica;
            font-size: 20px;
            color: #123456;
            background-color: #A3D5E4;
        }
        
        #text1 {
            font-size: 500px;
            color: #654321;
        }
    </style>
    <div>
        <center>
            <img src="/public/images/Picture1.jpg">
            </img>
        </center>
    </div>
    <body onLoad="step1()">
        <form action="@{quickSearch()}" method="GET">
        <font size="+3" color="993300">
            Welcome ${connected}!
        </font>
        </br>
        <a href="/Ideas Management/app/views/Application/index.html">Home</a>
        </br>
        <input type="text" id="search" name="search" value= "enter a keyword here" /><input type="button" id="submit" name="submit" value="Search" onclick="quickSearch(this.form)"/><a href="AdvancedSearch">Advanced Search</a>
        <script type="text/javascript">
            function step1(){
                document.getElementById('div1').innerHTML = '<center>Searching</br><img src="/public/images/Loading.gif"/></center>';
                setTimeout('viewResult()', 2000);
            }
            
            function viewResult(){
                document.getElementById('div1').innerHTML = "<center>#{if listOfResults} #{if organizationsFound} Found ${organizationsFound.size()} result${organizationsFound.pluralize()}<ul> #{list items:organizationsFound, as:'item'} <li><a href='@{Organization.show(item.id)}'>${item.toString()}</a></li> #{/list} </ul> #{/if}#{if entitiesFound} Found ${entitiesFound.size()} result${entitiesFound.pluralize()}<ul> #{list items:entitiesFound, as:'item'} <li><a href='@{MainEntity.show(item.id)}'>${item.toString()}</a></li> #{/list} </ul> #{/if} #{if topicsFound} Found ${topicsFound.size()} result${topicsFound.pluralize()}<ul> #{list items:topicsFound, as:'item'} <li><a href='@{Topic.show(item.id)}'>${item.toString()}</a></li> #{/list} </ul> #{/if} #{if ideasFound} Found ${ideasFound.size()} result${ideasFound.pluralize()}<ul> #{list items:ideasFound, as:'item'} <li><a href='@{Idea.show(item.id)}'>${item.toString()}</a></li> #{/list} </ul> #{/if} #{/if} #{else} Sorry! We did not find any results matching #{/else}</center>";
            }
            
            function quickSearch(frm){
                $.post('@{quickSearch}', {
                    keyword: frm.search.value
                }, function(){
                    window.location.reload(true);
                });
            }
        </script>
        </form>
        <br/>
        <center>
        <b>
            <big>
                <u>
                    Search Results:
                </u>
            </big>
        </b>
        </br>
        <i>
        </br>
        <a href="filter_options.html"><b>for filtering your results:
            </br>
            click here to chose your criteria</b>
    </a>
</i>
</center>
<div align="right">
    <u>
    <b>
    Sort by: 
    </u>
</b>
<form action="@{sortD()}" method = "GET">
<input type="radio" name="s" id = "s" value="sortA" />Ascending order
<br>
<input type="radio" name="s1" value="sortD" />descending order
</br><input type="radio" name="v" value="v" onchange="whichsortmethod(this.form)"/>Vote 
<input type="radio" name="r"value="r" onchange="whichsortmethod(this.form)"/>Rate 
</br>
</form>
<script type="text/javascript">
    function whichsortmethod(frm){
        if (frm.s1.checked) {   
            if (frm.v.checked) {
    var c = 'v'
                $.post('@{sortD}', {
                    voteOrRate: c,
                    searchresult: $listOfResults
                }, function(){
                    window.location.reload(true);
                });
            }
            else 
                if (frm.r.checked) {
                    $.post('@{sortD}', {
                        voteOrRate: 'r',
                        searchresult: $listOfResults
                    }, function(){
                        window.location.reload(true);
                    });
                }
            
        }
        else {
   document.write("else");
            if (frm.v.checked) {
                $.post('@{sortA}', {
                    voteOrRate: 'v',
                    searchresult: $listOfResults
                }, function(){
                    window.location.reload(true);
                });
            }
            else 
                if (frm.r.checked) {
                    $.post('@{sortA}', {
                        voteOrRate: 'r',
                        searchresult: $listOfResults
                    }, function(){
                        window.location.reload(true);
                    });
                }
        }
    }
</script>
<div id='div1'>
</div>
</body>
</html>