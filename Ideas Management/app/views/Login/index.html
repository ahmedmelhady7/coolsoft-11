#{extends 'main.html' /}
#{set title:'Home Page' /}

<script src="/public/javascripts/topbar_message/jquery.js" type="text/javascript"></script>
<script src="/public/javascripts/topbar_message/juery.topbar.js" type="text/javascript"></script>

 <link href="jquery.jnotify.css" rel="stylesheet" type="text/css" />
 <script src="/public/javascript/jnotify/jquery.jnotify.js" type="text/javascript"></script>

<!-- side bar -->
<div id="hmenu">
		<ul>
			<li><a href="@{Users.viewProfile()}" >Profile</a></li>
			<li><a href="@{Browse.browse()}" >Browse All</a></li>												     							
			<li>
			<a href="javascript:void(0)" id="demo01">Latest Notifications</a>
			<div id="demo01-body" style="display: none;">
				#{if user.notificationsNumber == 0}
					You have no notifications!!
				#{/if}
				#{else}
					#{if user.notificationsNumber == 1}
					<h1>user.notifications.get(0).title</h1>
					<p>user.notifications.get(0).description</p>					
					#{/if}
					#{else}
						#{if user.notificationsNumber == 2}
						#{/if}
						#{else}
							#{if user.notificationsNumber == 3}
							#{/if}
						#{/else}
					#{/else}
				#{/else}
			</div>
			</li>
			<li ><a href="@{Users.viewNotifications()}" >Notifications(${user.notificationsNumber})</a></li>
			<li><a href="@{Users.viewNotificationProfile()}" >Notification Profile</a></li>			
			<li>#{if !user.isAdmin}
									<a href="@{Invitations.view()}">Invitations</a>
 				#{/if}</li>	
		</ul>
</div>

<div id="sidebar">
					<ul>
						<li>
							<div id="search" >
								<form action="@{Search.quickSearch()}" method='post'>
										Search: <br>
										<input type="text" name="keyword" id="keyword" value="keyword" />
										<input type="image" src='/public/images/Search.jpg' id="submit" name="submit" value="GO" onclick="quickSearch(this.form)"/>										
										<br> <small><i><a href="/AdvancedSearch">Advanced Search</a></i></small>										
								</form>
							</div>
							<div style="clear: both;">&nbsp;</div>
						</li>
						<div style="clear: both;">&nbsp;</div>
						<li>
							<h2>${user.username}</h2> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							#{if user.profilePictureId != -1}							
							#{list items:user.profilePictureId, as:'id'}
							<img src="@{Pictures.getPicture(id)}" width="40" height="40"/>
							#{/list}
							#{/if}
							#{if user.profilePictureId == -1}
							<img src="/public/images/user.png" width="40" height="40"/>
							#{/if}
							<br>
							<b>E-Mail: </b>
							${user.email} <br>
							<b>Community Contribution Counter: </b>
							${user.communityContributionCounter} <br> 
							#{if !user.isAdmin}
							<a href="@{Users.confirmDeactivation()}">Deactivate</a>
							<br>
							#{/if}
							#{if user.isAdmin}							
							<a href="http://localhost:9008/admin">Admin View</a>
							<br>							
							#{/if}							
						</li>
						<div style="clear: both;">&nbsp;</div>
						<li>
							<h2>My Links</h2>
							<ul>								
 								<li><a href="@{Organizations.mainPage()}">My Organisations</a></li>
 								<li><a href="@{Organizations.viewAllOrganizations()}">All Organisations</a></li>
 								<li><a href="@{Items.viewAssignedItems()}">Assigned Items</a></li>
 								<li><a href="@{AssignRequests.view()}">Assigned Requests</a></li>
 								<li><input type="hidden" name="userId" value="${user.id}"></li>
 								<li><a href="@{Users.listFollows()}">Follow List</a></li> 
 								<li><a href="@{MarkRequest.markDuplicate()}">Duplicate Requests</a></li>								 								 								 															
							</ul>
						</li>		
						<li>
							<h2>My Documents</h2>
							<ul>
								<li><form action="@{Documents.newDocument()}" method="post">
										<input type="hidden" name="id" value="-1">
										Create a Document: <input type="submit" value="Create">
									</form>
								</li>
								<li>
								<form action="@{Documents.listDocument()}" method="post">
									<input type="hidden" name="id" value="-1">
									Show my Documents: <input type="submit" value="show">
								</form>
								</li>								
							</ul>
						</li>
						<li>
						<h2>My Gallery</h2>
							<ul>
								<li>
									<form action="@{Pictures.index()}" method="post">
									<input type="hidden" name="id" value="-1">
									Show my Gallery: <input type="submit" value="show">
									</form>
								</li>
							</ul>
						</li>
						<li>
						<h2>Drafts</h2>
							<ul>
								<li><a href="@{Ideas.getDrafts()}">Drafts (${user.getDraftsCount()})</a></li>						
							</ul>
						</li>
						<li>
						<h2>My Labels</h2>
							<ul>
							<li><a href="@{Labels.createLabel()}"">Create Label</a></li>
							<li><a href="@{Labels.showAllLabels()}">Manage Labels</a></li>
							</ul>
						</li>				
					</ul>					
			</div>
#{if flash.error}
   <b> <p style="color:green">
               ${flash.error}
    </p></b>
#{/if}
<body>
	#{doLayout /}
	</body>
	
<script type="text/javascript" language="javascript">
		$(function () {
 
			$("#demo01").click(function () {
				$('#demo01-body').showTopbarMessage();
			});
 
			$("#demo02").click(function () {
				$('#demo02-body').showTopbarMessage({ close: 5000 });
			});
 
			$("#demo03").click(function () {
				$('#demo03-body').showTopbarMessage({ background: "#093", close: 2000 });
			});
 
			$("#demo04").click(function () {
				$('#demo04-body').showTopbarMessage({ height: "150px", close: 2000 });
			});
		});	
</script>

<script type="text/javascript">
        function quickSearch(frm){
            $.post('@{Search.quickSearch()}', { keyword: frm.search1.value}, 
			function(){
                window.location.href = "/searchResult";
            });
        }
    </script>
<script type="text/javascript">
</script>
<form action="@{Notifications.notificationIndex()}" method="post">
	Send Notification: <i>(just for testing)</i><input type="submit" value="Notify">
</form>


