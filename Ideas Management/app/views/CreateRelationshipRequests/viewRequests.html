#{extends 'login/index.html' /}
<div id="pageNoSideBar">
  <a href="@{Organizations.viewProfile(id)}">Back to ${name}</a>  	
<br />
<br />
<tr><td><u><font size ="3" color ="black">Create Relationship Requests : </font></u></td><td>
<br />
<br />
#{if requests.isEmpty()}
<i><font size ="3" color ="blue">No new Requests</font></i>
#{/if}
#{else}
 #{list items:requests, as:'request'}
    <li>
        <fieldset id="request_0_${request.id}">
        <tr><td><font size ="3" color ="black">
			#{if request.type==0}
          
    	User <a href="@{Users.viewProfile(request.requester.id)}"> ${request.requester.username} </a> Wants to start relationship "${request.name}" between entities   <a href="@{MainEntitys.viewEntity(request.sourceEntity.id)}"> ${request.sourceEntity.name}</a> and  <a href="@{MainEntitys.viewEntity(request.destinationEntity.id)}"> ${request.destinationEntity.name}</a> </font></td><td>
            
			#{/if}
			#{else}
    	User <a href="@{Users.viewProfile(request.requester.id)}"> ${request.requester.username} </a> Wants to start relationship "${request.name}" between topics   <a href="@{Topics.show(request.sourceTopic.id)}"> ${request.sourceTopic.title}</a> and  <a href="@{Topics.show(request.destinationTopic.id)}"> ${request.destinationTopic.title}</a> </font></td><td>
			#{/else}
      <input type = "button" value = "Accept" onclick="javascript: respond(1,${request.id},${request.type},0,0)">
    	<input type = "button" value = "Reject" onclick="javascript: respond(0,${request.id},${request.type},0,0)">
        </fieldset>
    </li>
    #{/list}
#{/else}
<br />
<br />
<tr><td><u><font size ="3" color ="black">Rename Relationship Requests :</font></u></td><td>
<br />
<br />
#{if renamingRequests.isEmpty()}
<i><font size ="3" color ="blue">No new Requests</font></i>
#{/if}
#{else}
 #{list items:renamingRequests, as:'request'}
    <li>
        <fieldset id="request_1_${request.id}">
        <tr><td><font size ="3" color ="black">  
		#{if request.type==0}
    User <a href="@{Users.viewProfile(request.requester.id)}"> ${request.requester.username} </a> Wants to rename relationship " ${request.entityRelationship.name}" between entities <a href="@{MainEntitys.viewEntity(request.entityRelationship.source.id)}"> ${request.entityRelationship.source.name}</a> and  <a href="@{MainEntitys.viewEntity(request.entityRelationship.destination.id)}"> ${request.entityRelationship.destination.name}</a> to " ${request.newName} "</font></td><td>
            #{/if}
			#{else}
    	  User <a href="@{Users.viewProfile(request.requester.id)}"> ${request.requester.username} </a> Wants to rename relationship " ${request.topicRelationship.name} " between topics <a href="@{Topics.show(request.topicRelationship.source.id)}"> ${request.topicRelationship.source.title}</a> and  <a href="@{Topics.show(request.topicRelationship.destination.id)}"> ${request.topicRelationship.destination.title}</a> to " ${request.newName} "</font></td><td>
			#{/else}        
	      <input type = "button" value = "Accept" onclick="javascript: respond(1,${request.id},${request.type},1,1)">
			<input type = "button" value = "Reject" onclick="javascript: respond(0,${request.id},${request.type},1,1)">
        </fieldset>
    </li>
    #{/list}
#{/else}
<br />
<br />
<tr><td><u><font size ="3" color ="black">End Relationship Requests :</font></u></td><td>
<br />
<br />
#{if deletionRequests.isEmpty()}
<i><font size ="3" color ="blue">No new Requests</font></i>
#{/if}
#{else}
 #{list items:deletionRequests, as:'request'}
    <li>
        <fieldset id="request_2_${request.id}">
        <tr><td><font size ="3" color ="black">  
		
    	#{if request.type==0}
    User <a href="@{Users.viewProfile(request.requester.id)}"> ${request.requester.username} </a> Wants to end relationship " ${request.entityRelationship.name}" between entities <a href="@{MainEntitys.viewEntity(request.entityRelationship.source.id)}"> ${request.entityRelationship.source.name}</a> and  <a href="@{MainEntitys.viewEntity(request.entityRelationship.destination.id)}"> ${request.entityRelationship.destination.name}</a> </font></td><td>
            #{/if}
			#{else}
    	  User <a href="@{Users.viewProfile(request.requester.id)}"> ${request.requester.username} </a> Wants to end relationship " ${request.topicRelationship.name} " between topics <a href="@{Topics.show(request.topicRelationship.source.id)}"> ${request.topicRelationship.source.title}</a> and  <a href="@{Topics.show(request.topicRelationship.destination.id)}"> ${request.topicRelationship.destination.title}</a> </font></td><td>
			#{/else}        
	      <input type = "button" value = "Accept" onclick="javascript: respond(1,${request.id},${request.type},1,2)">
			<input type = "button" value = "Reject" onclick="javascript: respond(0,${request.id},${request.type},1,2)">
        </fieldset>
    </li>
    #{/list}
#{/else}
</div>
<script type="text/javascript">
function respond(stat, id,type,i,c){
	if (stat == 1) {
		if (c == 0) {
			$.post('@{respondToRequests()}', {
				status: stat,
				id: id,
				type: type,
				whichList: i
			}, function(){
				// alert("Accepted");
				$('#request_'+c+'_'+id).html('<i>Request has been accepted<\i>');
			//	window.location.reload();
			});
		}
		else{
				$.post('@{respondToRequests()}', {
				status: stat,
				id: id,
				type: type,
				whichList: i
			}, function(){
				// alert("Accepted");
			  //$('#request_'+c+'_'+id).html('<i>Request has been accepted<\i>');
				window.location.reload();
			});
		}	
	}
	else {
		$.post('@{respondToRequests()}', {
		status:stat, id: id,type:type,whichList:i
		}, function()
			 {
			// alert("Accepted");
			$('#request_'+c+'_'+id).html('<i>Request has been rejected<\i>');
			});	
	}
	
}


</script>